<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ydant Examples</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-900 min-h-screen text-gray-200">
    <div class="container mx-auto px-4 py-8">
      <header class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-100 mb-2">Ydant Examples</h1>
        <p class="text-gray-400">Generator-based DOM rendering DSL</p>
      </header>

      <div id="grid" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3"></div>

      <footer class="text-center mt-12 text-gray-500 text-sm">
        <p>Ydant - You Don't Actually Need This</p>
      </footer>
    </div>

    <script type="module">
      const modules = import.meta.glob('./showcase*/package.json', { eager: true });

      const tagColors = {
        reactive: ['bg-blue-900/40', 'text-blue-300'],
        router: ['bg-orange-900/40', 'text-orange-300'],
        context: ['bg-amber-900/40', 'text-amber-300'],
        async: ['bg-red-900/40', 'text-red-300'],
        transition: ['bg-pink-900/40', 'text-pink-300'],
        canvas: ['bg-emerald-900/40', 'text-emerald-300'],
        portal: ['bg-violet-900/40', 'text-violet-300'],
        ssr: ['bg-cyan-900/40', 'text-cyan-300'],
        devtools: ['bg-purple-900/40', 'text-purple-300'],
      };

      const showcases = Object.entries(modules)
        .map(([path, mod]) => {
          const num = Number(path.match(/showcase(\d+)/)[1]);
          const pkg = mod.default;
          const deps = Object.keys(pkg.dependencies ?? {})
            .filter((d) => d.startsWith('@ydant/') && d !== '@ydant/core' && d !== '@ydant/base')
            .map((d) => d.replace('@ydant/', ''));
          return { num, description: pkg.description ?? '', deps };
        })
        .sort((a, b) => a.num - b.num);

      const grid = document.getElementById('grid');

      for (const { num, description, deps } of showcases) {
        const tags = deps
          .map((dep) => {
            const [bg, text] = tagColors[dep] ?? ['bg-slate-700', 'text-gray-300'];
            return `<span class="px-2 py-1 ${bg} ${text} text-xs rounded">${dep}</span>`;
          })
          .join('');

        grid.insertAdjacentHTML(
          'beforeend',
          `<a href="./showcase${num}/" class="block bg-slate-800 rounded-lg border border-slate-700 hover:border-slate-500 transition-colors p-6">
            <h2 class="text-xl font-semibold text-gray-100 mb-2">Showcase ${num}</h2>
            <p class="text-gray-400 text-sm mb-4">${description}</p>
            ${tags ? `<div class="flex flex-wrap gap-2">${tags}</div>` : ''}
          </a>`,
        );
      }
    </script>
  </body>
</html>
